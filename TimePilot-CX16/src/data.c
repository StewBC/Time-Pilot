//-----------------------------------------------------------------------------
// data.c
// Part of Time Pilot, the 1982 arcade game remake for the Commander X16
//
// Stefan Wessels, 2024
// This is free and unencumbered software released into the public domain.

#include <stdint.h>
#include "globals.h"

#include "ai.h"
#include "collide.h"
#include "data.h"
#include "draw.h"
#include "print.h"
#include "text.h"

#include <cbm.h>
#include <cx16.h>
#include <stdio.h>

//-----------------------------------------------------------------------------
// Each layer has an entry
jumpFunction sprite_draw[] =  {
    drawSetSpritePosition,      // LAYER_CLOUDS0
    drawSetSpritePosition,      // LAYER_ASTROS0
    drawSetSpritePosition,      // LAYER_CLOUDS1
    drawSetSpritePosition,      // LAYER_ASTROS1
    drawSetSpritePosition,      // LAYER_ENEMY_BULLETS
    drawEnemySpaceBullets,      // LAYER_ENEMY_SPACEBULLETS
    drawEnemyBombs,             // LAYER_ENEMY_BOMBS
    drawEnemyRockets,           // LAYER_ENEMY_ROCKETS
    drawEnemyBoomerang,         // LAYER_ENEMY_BOOMERANG
    drawEnemyP0P1P3,            // LAYER_ENEMY
    drawSetSpritePosition,      // LAYER_PLAYER_BULLETS
    drawParachute,              // LAYER_PARACHUTE
    drawEnemyBomber,            // LAYER_BOMBER
    drawLevelBossP0P1P2P3,      // LAYER_LEVELBOSS
    drawRts,                    // LAYER_WARP
    drawPlayer,                 // LAYER_PLAYER
    drawSetSpritePosition,      // LAYER_CLOUDS2
    drawSetSpritePosition,      // LAYER_ASTROS2
    drawScores,                 // LAYER_SCORES
};

jumpFunction sprite_draw_dead[] = {
    drawRts,                    // LAYER_CLOUDS0
    drawRts,                    // LAYER_ASTROS0
    drawRts,                    // LAYER_CLOUDS1
    drawRts,                    // LAYER_ASTROS1
    drawRts,                    // LAYER_ENEMY_BULLETS
    draw13x13Expl_sblt,         // LAYER_ENEMY_SPACEBULLETS
    draw16x16Expl_wep,          // LAYER_ENEMY_BOMBS
    draw16x16Expl_wep,          // LAYER_ENEMY_ROCKETS
    draw11x11Expl_boom,         // LAYER_ENEMY_BOOMERANG
    draw16x16Explosion,         // LAYER_ENEMY
    drawRts,                    // LAYER_PLAYER_BULLETS
    drawRts,                    // LAYER_PARACHUTE
    draw32x16Explosion,         // LAYER_BOMBER
    draw32x16Explosion,         // LAYER_LEVELBOSS
    drawRts,                    // LAYER_WARP
    draw32x16Explosion,         // LAYER_PLAYER
    drawRts,                    // LAYER_CLOUDS2
    drawRts,                    // LAYER_ASTROS2
    drawRts,                    // LAYER_SCORES
};

jumpFunction ai_handler[] = {
    aiClouds0,                  // LAYER_CLOUDS0
    aiClouds0,                  // LAYER_ASTROS0
    aiClouds1,                  // LAYER_CLOUDS1
    aiClouds1,                  // LAYER_ASTROS1
    aiEnemyBullets,             // LAYER_ENEMY_BULLETS
    aiEnemySpaceBullets,        // LAYER_ENEMY_SPACEBULLETS
    aiEnemyBombs,               // LAYER_ENEMY_BOMBS
    aiEnemyRockets,             // LAYER_ENEMY_ROCKETS
    aiEnemyBoomerang,           // LAYER_ENEMY_BOOMERANG
    aiEnemy,                    // LAYER_ENEMY
    aiPlayerBullets,            // LAYER_PLAYER_BULLETS
    aiParachute,                // LAYER_PARACHUTE
    aiBomber,                   // LAYER_BOMBER
    aiLevelBoss,                // LAYER_LEVELBOSS
    drawRts,                    // LAYER_WARP
    aiPlayer,                   // LAYER_PLAYER
    aiClouds2,                  // LAYER_CLOUDS2
    aiClouds2,                  // LAYER_ASTROS2
    aiScores,                   // LAYER_SCORES
};

collideJumpFunction collision_handler[] = {
    collideRts,                 // LAYER_CLOUDS0
    collideRts,                 // LAYER_ASTROS0
    collideRts,                 // LAYER_CLOUDS1
    collideRts,                 // LAYER_ASTROS1
    collideRemove,              // LAYER_ENEMY_BULLETS
    collideEnemySpaceBullets,   // LAYER_ENEMY_SPACEBULLETS
    collideEnemyRockets,        // LAYER_ENEMY_BOMBS
    collideEnemyRockets,        // LAYER_ENEMY_ROCKETS
    collideEnemyBoomerang,      // LAYER_ENEMY_BOOMERANG
    collideEnemy,               // LAYER_ENEMY
    collideRemove,              // LAYER_PLAYER_BULLETS
    collideParachute,           // LAYER_PARACHUTE
    collideBomber,              // LAYER_BOMBER
    collideLevelBoss,           // LAYER_LEVELBOSS
    collideRts,                 // LAYER_WARP
    collidePlayer,              // LAYER_PLAYER
    collideRts,                 // LAYER_CLOUDS2
    collideRts,                 // LAYER_ASTROS2
    collideRts,                 // LAYER_SCORES
};

//-----------------------------------------------------------------------------
// Layer specific init values
uint8_t layerCollides[LAYER_NUM_LAYERS] = {
    COLLIDE_NONE,                                                                      // LAYER_CLOUDS0
    COLLIDE_NONE,                                                                      // LAYER_ASTROS0
    COLLIDE_NONE,                                                                      // LAYER_CLOUDS1
    COLLIDE_NONE,                                                                      // LAYER_ASTROS1
    COLLIDE_PLAYER,                                                                    // LAYER_ENEMY_BULLETS
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_ENEMY_SPACEBULLETS
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_ENEMY_BOMBS
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_ENEMY_ROCKETS
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_ENEMY_BOOMERANG
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_ENEMY
    COLLIDE_ENEMY | COLLIDE_ENEMY_ROCKETS,                                             // LAYER_PLAYER_BULLETS
    COLLIDE_PLAYER,                                                                    // LAYER_PARACHUTE
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_BOMBER
    COLLIDE_PLAYER_BULLETS | COLLIDE_PLAYER,                                           // LAYER_LEVELBOSS
    COLLIDE_NONE,                                                                      // LAYER_WARP
    COLLIDE_ENEMY | COLLIDE_ENEMY_BULLETS | COLLIDE_ENEMY_ROCKETS | COLLIDE_PARACHUTE, // LAYER_PLAYER
    COLLIDE_NONE,                                                                      // LAYER_CLOUDS2
    COLLIDE_NONE,                                                                      // LAYER_ASTROS2
    COLLIDE_NONE,                                                                      // LAYER_SCORES
};

uint8_t layerColsig[LAYER_NUM_LAYERS] = {
    COLLIDE_NONE,               // LAYER_CLOUDS0
    COLLIDE_NONE,               // LAYER_ASTROS0
    COLLIDE_NONE,               // LAYER_CLOUDS1
    COLLIDE_NONE,               // LAYER_ASTROS1
    COLLIDE_ENEMY_BULLETS,      // LAYER_ENEMY_BULLETS
    COLLIDE_ENEMY_BULLETS,      // LAYER_ENEMY_SPACEBULLETS
    COLLIDE_ENEMY,              // LAYER_ENEMY_BOMBS
    COLLIDE_ENEMY,              // LAYER_ENEMY_ROCKETS
    COLLIDE_ENEMY,              // LAYER_ENEMY_BOOMERANG
    COLLIDE_ENEMY,              // LAYER_ENEMY
    COLLIDE_PLAYER_BULLETS,     // LAYER_PLAYER_BULLETS
    COLLIDE_PARACHUTE,          // LAYER_PARACHUTE
    COLLIDE_ENEMY,              // LAYER_BOMBER
    COLLIDE_ENEMY,              // LAYER_LEVELBOSS
    COLLIDE_NONE,               // LAYER_WARP
    COLLIDE_PLAYER,             // LAYER_PLAYER
    COLLIDE_NONE,               // LAYER_CLOUDS2
    COLLIDE_NONE,               // LAYER_ASTROS2
    COLLIDE_NONE,               // LAYER_SCORES
};

uint16_t layerFlags[LAYER_NUM_LAYERS] = {
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_CLOUDS0
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_ASTROS0
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_CLOUDS1
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_ASTROS1
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_ENEMY_BULLETS
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_ENEMY_SPACEBULLETS
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_ENEMY_BOMBS
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_ENEMY_ROCKETS
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_ENEMY_BOOMERANG
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_ENEMY
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_PLAYER_BULLETS
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_PARACHUTE
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_BOMBER
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_LEVELBOSS
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_WARP
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_NONE,                       // LAYER_PLAYER
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_CLOUDS2
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_ASTROS2
    ACTIVEFLAGS_INUSE | ACTIVEFLAGS_CLIPMASK | ACTIVEFLAGS_WRAPS,                      // LAYER_SCORES
};

uint8_t layerHeight[LAYER_NUM_LAYERS] = {
    9,                          // LAYER_CLOUDS0
    12,                         // LAYER_ASTROS0
    14,                         // LAYER_CLOUDS1
    15,                         // LAYER_ASTROS1
    2,                          // LAYER_ENEMY_BULLETS
    7,                          // LAYER_ENEMY_SPACEBULLETS
    3,                          // LAYER_ENEMY_BOMBS
    9,                          // LAYER_ENEMY_ROCKETS
    6,                          // LAYER_ENEMY_BOOMERANG
    16,                         // LAYER_ENEMY
    2,                          // LAYER_PLAYER_BULLETS
    16,                         // LAYER_PARACHUTE
    9,                          // LAYER_BOMBER
    16,                         // LAYER_LEVELBOSS
    16,                         // LAYER_WARP
    16,                         // LAYER_PLAYER
    16,                         // LAYER_CLOUDS2
    14,                         // LAYER_ASTROS2
    16,                         // LAYER_SCORES
};

uint8_t layerWidth[LAYER_NUM_LAYERS] = {
    16,                         // LAYER_CLOUDS0
    14,                         // LAYER_ASTROS0
    30,                         // LAYER_CLOUDS1
    14,                         // LAYER_ASTROS1
    2,                          // LAYER_ENEMY_BULLETS
    7,                          // LAYER_ENEMY_SPACEBULLETS
    6,                          // LAYER_ENEMY_BOMBS
    9,                          // LAYER_ENEMY_ROCKETS
    6,                          // LAYER_ENEMY_BOOMERANG
    16,                         // LAYER_ENEMY
    2,                          // LAYER_PLAYER_BULLETS
    16,                         // LAYER_PARACHUTE
    28,                         // LAYER_BOMBER
    32,                         // LAYER_LEVELBOSS
    16,                         // LAYER_WARP
    16,                         // LAYER_PLAYER
    46,                         // LAYER_CLOUDS2
    27,                         // LAYER_ASTROS2
    16,                         // LAYER_SCORES
};

//-----------------------------------------------------------------------------
// Initial spawn layer info
const int8_t spawnLayer[NUM_SPAWN_LAYERS] = {
    LAYER_CLOUDS0,
    LAYER_CLOUDS1,
    LAYER_CLOUDS2,
    LAYER_CLOUDS1,
    LAYER_CLOUDS0,
    LAYER_CLOUDS1,
    LAYER_CLOUDS2,
    LAYER_CLOUDS1,
    LAYER_PLAYER,
};

const int16_t spawnMinX[NUM_SPAWN_LAYERS] = {
    128,                        // LAYER_CLOUDS0
    -8,                         // LAYER_CLOUDS1
    160,                        // LAYER_CLOUDS2
    32,                         // LAYER_CLOUDS1
    0,                          // LAYER_CLOUDS0
    112,                        // LAYER_CLOUDS1
    32,                         // LAYER_CLOUDS2
    160,                        // LAYER_CLOUDS1
    PLAYER_X,                   // LAYER_PLAYER
};

const int16_t spawnMinY[NUM_SPAWN_LAYERS] = {
    216,                        // LAYER_CLOUDS0
    212,                        // LAYER_CLOUDS1
    193,                        // LAYER_CLOUDS2
    146,                        // LAYER_CLOUDS1
    77,                         // LAYER_CLOUDS0
    72,                         // LAYER_CLOUDS1
    54,                         // LAYER_CLOUDS2
    0,                          // LAYER_CLOUDS1
    PLAYER_Y,                   // LAYER_PLAYER
};

const int8_t spawnSpaceLayer[NUM_SPAWN_LAYERS] = {
    LAYER_ASTROS0,
    LAYER_ASTROS1,
    LAYER_ASTROS2,
    LAYER_ASTROS1,
    LAYER_ASTROS0,
    LAYER_ASTROS1,
    LAYER_ASTROS2,
    LAYER_ASTROS1,
    LAYER_PLAYER,
};

//-----------------------------------------------------------------------------
// Screen/AI related - where to launch, how to move, where to move to, etc.
// around the sceeen at 11.25 degree angles
const int16_t launchPosX[] = {
    0x00E0,0x00E0,0x00E0,0x00E0,0x00E0,0x00C6,0x00A9,0x0089,
    0x0068,0x0047,0x0027,0x000A,0xFFF0,0xFFF0,0xFFF0,0xFFF0,
    0xFFF0,0xFFF0,0xFFF0,0xFFF0,0xFFF0,0x000A,0x0027,0x0047,
    0x0068,0x0089,0x00A9,0x00C6,0x00E0,0x00E0,0x00E0,0x00E0,
};

const int16_t launchPosY[] = {
    0x0070,0x0093,0x00B5,0x00D5,0x00F0,0x00F0,0x00F0,0x00F0,
    0x00F0,0x00F0,0x00F0,0x00F0,0x00F0,0x00D5,0x00B5,0x0093,
    0x0070,0x004D,0x002B,0x000B,0xFFF0,0xFFF0,0xFFF0,0xFFF0,
    0xFFF0,0xFFF0,0xFFF0,0xFFF0,0xFFF0,0x000B,0x002B,0x004D,
};

// -128 to 368 with negatives wrapping to col/row 24.  Centre at (112,11214520)
const int8_t rays[32][32] = {
    {4 ,4 ,5 ,5 ,6 ,7 ,7 ,8 ,9 ,9 ,10,11,11,12,12,12,13,13,13,13,13,14,14,14,2 ,2 ,3 ,3 ,3 ,3 ,3 ,4 },
    {4 ,4 ,4 ,5 ,6 ,6 ,7 ,8 ,9 ,10,10,11,12,12,12,13,13,13,13,14,14,14,14,14,2 ,2 ,2 ,2 ,3 ,3 ,3 ,3 },
    {3 ,4 ,4 ,5 ,5 ,6 ,7 ,8 ,9 ,10,11,11,12,12,13,13,13,14,14,14,14,14,14,14,2 ,2 ,2 ,2 ,2 ,2 ,3 ,3 },
    {3 ,3 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10,11,12,13,13,13,14,14,14,14,14,14,15,15,15,1 ,1 ,2 ,2 ,2 ,2 ,2 ,2 },
    {2 ,2 ,3 ,3 ,4 ,5 ,6 ,8 ,10,11,12,13,13,14,14,14,14,15,15,15,15,15,15,15,1 ,1 ,1 ,1 ,1 ,1 ,2 ,2 },
    {1 ,2 ,2 ,2 ,3 ,4 ,6 ,8 ,10,12,13,14,14,14,15,15,15,15,15,15,15,15,15,15,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 },
    {1 ,1 ,1 ,1 ,2 ,2 ,4 ,8 ,12,14,14,15,15,15,15,15,15,15,16,16,16,16,16,16,0 ,0 ,0 ,0 ,0 ,1 ,1 ,1 },
    {0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 },
    {31,31,31,31,30,30,28,24,20,18,18,17,17,17,17,17,17,17,16,16,16,16,16,16,0 ,0 ,0 ,0 ,0 ,31,31,31},
    {31,30,30,30,29,28,26,24,22,20,19,18,18,18,17,17,17,17,17,17,17,17,17,17,31,31,31,31,31,31,31,31},
    {30,30,29,29,28,27,26,24,22,21,20,19,19,18,18,18,18,17,17,17,17,17,17,17,31,31,31,31,31,31,30,30},
    {29,29,29,28,27,26,25,24,23,22,21,20,19,19,19,18,18,18,18,18,18,17,17,17,31,31,30,30,30,30,30,30},
    {29,28,28,27,27,26,25,24,23,22,21,21,20,20,19,19,19,18,18,18,18,18,18,18,30,30,30,30,30,30,29,29},
    {28,28,28,27,26,26,25,24,23,22,22,21,20,20,20,19,19,19,19,18,18,18,18,18,30,30,30,30,29,29,29,29},
    {28,28,27,27,26,25,25,24,23,23,22,21,21,20,20,20,19,19,19,19,19,18,18,18,30,30,29,29,29,29,29,28},
    {28,27,27,26,26,25,25,24,23,23,22,22,21,21,20,20,20,19,19,19,19,19,18,18,30,29,29,29,29,29,28,28},
    {27,27,27,26,26,25,25,24,23,23,22,22,21,21,21,20,20,20,19,19,19,19,19,19,29,29,29,29,29,28,28,28},
    {27,27,26,26,25,25,25,24,23,23,23,22,22,21,21,21,20,20,20,20,19,19,19,19,29,29,29,28,28,28,28,27},
    {27,27,26,26,25,25,24,24,24,23,23,22,22,21,21,21,21,20,20,20,20,19,19,19,29,29,28,28,28,28,27,27},
    {27,26,26,26,25,25,24,24,24,23,23,22,22,22,21,21,21,20,20,20,20,20,19,19,29,28,28,28,28,28,27,27},
    {27,26,26,26,25,25,24,24,24,23,23,22,22,22,21,21,21,21,20,20,20,20,20,19,28,28,28,28,28,27,27,27},
    {26,26,26,25,25,25,24,24,24,23,23,23,22,22,22,21,21,21,21,20,20,20,20,20,28,28,28,28,27,27,27,27},
    {26,26,26,25,25,25,24,24,24,23,23,23,22,22,22,22,21,21,21,21,20,20,20,20,28,28,28,27,27,27,27,26},
    {26,26,26,25,25,25,24,24,24,23,23,23,22,22,22,22,21,21,21,21,21,20,20,20,28,28,27,27,27,27,27,26},
    {6 ,6 ,6 ,7 ,7 ,7 ,8 ,8 ,8 ,9 ,9 ,9 ,10,10,10,10,11,11,11,11,12,12,12,12,4 ,4 ,4 ,5 ,5 ,5 ,5 ,6 },
    {6 ,6 ,6 ,7 ,7 ,7 ,8 ,8 ,8 ,9 ,9 ,9 ,10,10,10,11,11,11,11,12,12,12,12,12,4 ,4 ,4 ,4 ,5 ,5 ,5 ,5 },
    {5 ,6 ,6 ,6 ,7 ,7 ,8 ,8 ,8 ,9 ,9 ,10,10,10,11,11,11,11,12,12,12,12,12,13,4 ,4 ,4 ,4 ,4 ,5 ,5 ,5 },
    {5 ,6 ,6 ,6 ,7 ,7 ,8 ,8 ,8 ,9 ,9 ,10,10,10,11,11,11,12,12,12,12,12,13,13,3 ,4 ,4 ,4 ,4 ,4 ,5 ,5 },
    {5 ,5 ,6 ,6 ,7 ,7 ,8 ,8 ,8 ,9 ,9 ,10,10,11,11,11,11,12,12,12,12,13,13,13,3 ,3 ,4 ,4 ,4 ,4 ,5 ,5 },
    {5 ,5 ,6 ,6 ,7 ,7 ,7 ,8 ,9 ,9 ,9 ,10,10,11,11,11,12,12,12,12,13,13,13,13,3 ,3 ,3 ,4 ,4 ,4 ,4 ,5 },
    {5 ,5 ,5 ,6 ,6 ,7 ,7 ,8 ,9 ,9 ,10,10,11,11,11,12,12,12,13,13,13,13,13,13,3 ,3 ,3 ,3 ,3 ,4 ,4 ,4 },
    {4 ,5 ,5 ,6 ,6 ,7 ,7 ,8 ,9 ,9 ,10,10,11,11,12,12,12,13,13,13,13,13,14,14,2 ,3 ,3 ,3 ,3 ,3 ,4 ,4 },
};

const uint8_t velXfrac[] = {
    0x80,0x7E,0x76,0x6A,0x5B,0x47,0x31,0x19,  // 0.5
    0x00,0xE7,0xCF,0xB9,0xA5,0x96,0x8A,0x82,
    0x80,0x82,0x8A,0x96,0xA5,0xB9,0xCF,0xE7,
    0x00,0x19,0x31,0x47,0x5B,0x6A,0x76,0x7E,
    0xC0,0xBC,0xB1,0xA0,0x88,0x6B,0x49,0x25,  // 0.75
    0x00,0xDB,0xB7,0x95,0x78,0x60,0x4F,0x44,
    0x40,0x44,0x4F,0x60,0x78,0x95,0xB7,0xDB,
    0x00,0x25,0x49,0x6B,0x88,0xA0,0xB1,0xBC,
    0x00,0xFB,0xED,0xD5,0xB5,0x8E,0x62,0x32,  // 1.0
    0x00,0xCE,0x9E,0x72,0x4B,0x2B,0x13,0x05,
    0x00,0x05,0x13,0x2B,0x4B,0x72,0x9E,0xCE,
    0x00,0x32,0x62,0x8E,0xB5,0xD5,0xED,0xFB,
    0x31,0x2B,0x19,0xFD,0xD7,0xA9,0x75,0x3B,  // 1.19
    0x00,0xC5,0x8B,0x57,0x29,0x03,0xE7,0xD5,
    0xCF,0xD5,0xE7,0x03,0x29,0x57,0x8B,0xC5,
    0x00,0x3B,0x75,0xA9,0xD7,0xFD,0x19,0x2B,
    0x80,0x79,0x63,0x3F,0x10,0xD5,0x93,0x4B,  // 1.5
    0x00,0xB5,0x6D,0x2B,0xF0,0xC1,0x9D,0x87,
    0x80,0x87,0x9D,0xC1,0xF0,0x2B,0x6D,0xB5,
    0x00,0x4B,0x93,0xD5,0x10,0x3F,0x63,0x79,
    0x00,0xF6,0xD9,0xAA,0x6A,0x1C,0xC4,0x64,  // 2.0
    0x00,0x9C,0x3C,0xE4,0x96,0x56,0x27,0x0A,
    0x00,0x0A,0x27,0x56,0x96,0xE4,0x3C,0x9C,
    0x00,0x64,0xC4,0x1C,0x6A,0xAA,0xD9,0xF6,
    0x00,0xEC,0xB2,0x53,0xD4,0x39,0x88,0xC8,  // 4.0
    0x00,0x38,0x78,0xC7,0x2C,0xAD,0x4E,0x14,
    0x00,0x14,0x4E,0xAD,0x2C,0xC7,0x78,0x38,
    0x00,0xC8,0x88,0x39,0xD4,0x53,0xB2,0xEC,
};

const int8_t velXwhole[] = {
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // 0.5
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // 0.75
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // 1.0
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,  // 1.19
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,
    0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,
    0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,  // 1.5
    0x00,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,
    0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,
    0x02,0x01,0x01,0x01,0x01,0x01,0x00,0x00,  // 2.0
    0x00,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,
    0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,
    0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,
    0x04,0x03,0x03,0x03,0x02,0x02,0x01,0x00,  // 4.0
    0x00,0xFF,0xFE,0xFD,0xFD,0xFC,0xFC,0xFC,
    0xFC,0xFC,0xFC,0xFC,0xFD,0xFD,0xFE,0xFF,
    0x00,0x00,0x01,0x02,0x02,0x03,0x03,0x03,
};

const uint8_t velYfrac[] = {
    0x00,0x19,0x31,0x47,0x5B,0x6A,0x76,0x7E,  // 0.5
    0x80,0x7E,0x76,0x6A,0x5B,0x47,0x31,0x19,
    0x00,0xE7,0xCF,0xB9,0xA5,0x96,0x8A,0x82,
    0x80,0x82,0x8A,0x96,0xA5,0xB9,0xCF,0xE7,
    0x00,0x25,0x49,0x6B,0x88,0xA0,0xB1,0xBC,  // 0.75
    0xC0,0xBC,0xB1,0xA0,0x88,0x6B,0x49,0x25,
    0x00,0xDB,0xB7,0x95,0x78,0x60,0x4F,0x44,
    0x40,0x44,0x4F,0x60,0x78,0x95,0xB7,0xDB,
    0x00,0x32,0x62,0x8E,0xB5,0xD5,0xED,0xFB,  // 1.0
    0x00,0xFB,0xED,0xD5,0xB5,0x8E,0x62,0x32,
    0x00,0xCE,0x9E,0x72,0x4B,0x2B,0x13,0x05,
    0x00,0x05,0x13,0x2B,0x4B,0x72,0x9E,0xCE,
    0x00,0x3B,0x75,0xA9,0xD7,0xFD,0x19,0x2B,  // 1.19
    0x31,0x2B,0x19,0xFD,0xD7,0xA9,0x75,0x3B,
    0x00,0xC5,0x8B,0x57,0x29,0x03,0xE7,0xD5,
    0xCF,0xD5,0xE7,0x03,0x29,0x57,0x8B,0xC5,
    0x00,0x4B,0x93,0xD5,0x10,0x3F,0x63,0x79,  // 1.5
    0x80,0x79,0x63,0x3F,0x10,0xD5,0x93,0x4B,
    0x00,0xB5,0x6D,0x2B,0xF0,0xC1,0x9D,0x87,
    0x80,0x87,0x9D,0xC1,0xF0,0x2B,0x6D,0xB5,
    0x00,0x64,0xC4,0x1C,0x6A,0xAA,0xD9,0xF6,  // 2.0
    0x00,0xF6,0xD9,0xAA,0x6A,0x1C,0xC4,0x64,
    0x00,0x9C,0x3C,0xE4,0x96,0x56,0x27,0x0A,
    0x00,0x0A,0x27,0x56,0x96,0xE4,0x3C,0x9C,
    0x00,0xC8,0x88,0x39,0xD4,0x53,0xB2,0xEC,  // 4.0
    0x00,0xEC,0xB2,0x53,0xD4,0x39,0x88,0xC8,
    0x00,0x38,0x78,0xC7,0x2C,0xAD,0x4E,0x14,
    0x00,0x14,0x4E,0xAD,0x2C,0xC7,0x78,0x38,
};

const int8_t velYwhole[] = {
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // 0.5
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // 0.75
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  // 1.0
    0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,  // 1.19
    0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,
    0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,
    0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,  // 1.5
    0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,
    0x00,0xFF,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,
    0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF,
    0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,  // 2.0
    0x02,0x01,0x01,0x01,0x01,0x01,0x00,0x00,
    0x00,0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xFE,
    0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,
    0x00,0x00,0x01,0x02,0x02,0x03,0x03,0x03,  // 4.0
    0x04,0x03,0x03,0x03,0x02,0x02,0x01,0x00,
    0x00,0xFF,0xFE,0xFD,0xFD,0xFC,0xFC,0xFC,
    0xFC,0xFC,0xFC,0xFC,0xFD,0xFD,0xFE,0xFF,
};

//-----------------------------------------------------------------------------
// General tables
const int8_t bonusScores[NUM_SCORES] = {
    10, 20, 30, 40, 50, 15,
};

const int8_t bossAnimFrames[4] = {
    3, 3, 2, 1
};

// 0RGB
const uint16_t colorPalette[16] = {
    0x0000,                   // BLACK
    0x0F00,                   // RED
    0x00C0,                   // GREEN
    0x005F,                   // BLUE
    0x0FF0,                   // YELLOW
    0x0F80,                   // ORANGE
    0x0C0C,                   // MAGENTA
    0x00CF,                   // CYAN
    0x0888,                   // GRAY
    0x0FFF,                   // WHITE
    0x0800,                   // RED (DARK)
    0x0680,                   // GREEN (DARK)
    0x000A,                   // BLUE (DARK)
    0x0BB0,                   // YELLOW (DARK)
    0x6135,                   // SKY
    0x0000,                   // Extra - also prop color in pallet row 2
};

const uint16_t colorPaletteProps[3] = {
    0x0680,                   // TIME_PERIOD0_1910
    0x00c0,                   // TIME_PERIOD1_1940
    0x0fff,                   // TIME_PERIOD2_1970
};

const uint16_t colorPaletteSky[5] = {
    0x0006,                   // TIME_PERIOD0_1910
    0x0056,                   // TIME_PERIOD1_1940
    0x0065,                   // TIME_PERIOD2_1970
    0x0505,                   // TIME_PERIOD3_1982
    0x0000,                   // TIME_PERIOD4_2001
};

const uint8_t explode_16x16_hold_table[4] = {
    4, 8, 4, 4
};

const uint8_t explode_32x16_hold_table[4] = {
    8, 16, 8, 8
};

const int8_t heliFrameMap[] = {
    0, 0, 1, 1, 2, 2, 3, 3,
    4, 5, 5, 6, 6, 7, 7, 8,
    8, 8, 7, 7, 6, 6, 5, 5,
    4, 3, 3, 2, 2, 1, 1, 0
};

const uint8_t highScoreColorIndex[5] = {
    TP_COLOR_RED,
    TP_COLOR_ORANGE,
    TP_COLOR_YELLOW,
    TP_COLOR_GREEN,
    TP_COLOR_CYAN
};

const uint8_t highScoreInitialsY[] = {
    8,
    10,
    12,
    14,
    16
};

const int16_t horizontalDirectionTable[] = {
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT), // Same flag, for clarity
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    (ACTIVEFLAGS_MULTIPURPOSE | ACTIVEFLAGS_DIR_RIGHT),
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE,
    ACTIVEFLAGS_NONE
};

const int8_t horizontalLaunchRayTable[] = {
    0 , 1 , 2 , 3 , 3 , 3 , 3 , 3 ,
    13, 13, 13, 13, 13, 13, 14, 15,
    16, 17, 18, 19, 19, 19, 19, 19,
    29, 29, 29, 29, 29, 29, 30, 31
};

const int8_t layerToThingTable[] = {
    63,             //LAYER_CLOUDS0
    63,             //LAYER_ASTROS0
    61,             //LAYER_CLOUDS1
    61,             //LAYER_ASTROS1
    59,             //LAYER_ENEMY_BULLETS
    59,             //LAYER_ENEMY_SPACEBULLETS
    55,             //LAYER_ENEMY_BOMBS
    51,             //LAYER_ENEMY_ROCKETS
    51,             //LAYER_ENEMY_BOOMERANG
    47,             //LAYER_ENEMY
    39,             //LAYER_PLAYER_BULLETS
    18,             //LAYER_PARACHUTE
    17,             //LAYER_BOMBER
    16,             //LAYER_LEVELBOSS
    15,             //LAYER_WARP
    7,              //LAYER_PLAYER
    6,              //LAYER_CLOUDS2
    6,              //LAYER_ASTROS2
    4,              //LAYER_SCORES
};

const int8_t parachute_sprite_table[6] = {
    0, 1, 2, 3, 2, 1
};

// The movement mask & 15 indexes into this to see the desired playerAngle. -1 is not valid
const int8_t playerJoyAngles[16] = {
    -1, 24, 0 , 28, 8 , -1, 4 , -1,
    16, 20, -1, -1, 12, -1, -1, -1
};

const int8_t spriteSizeByLayer[] = 
{
    //          W , H
    ENCODE_SIZE(16,16), // LAYER_CLOUDS0
    ENCODE_SIZE(16,16), // LAYER_ASTROS0
    ENCODE_SIZE(32,16), // LAYER_CLOUDS1
    ENCODE_SIZE(16,16), // LAYER_ASTROS1
    ENCODE_SIZE(8 ,8 ), // LAYER_ENEMY_BULLETS
    ENCODE_SIZE(8, 8 ), // LAYER_ENEMY_SPACEBULLETS
    ENCODE_SIZE(8 ,8 ), // LAYER_ENEMY_BOMBS
    ENCODE_SIZE(16,16), // LAYER_ENEMY_ROCKETS
    ENCODE_SIZE(8 ,8 ), // LAYER_ENEMY_BOOMERANG
    ENCODE_SIZE(16,16), // LAYER_ENEMY
    ENCODE_SIZE(8 ,8 ), // LAYER_PLAYER_BULLETS
    ENCODE_SIZE(16,16), // LAYER_PARACHUTE
    ENCODE_SIZE(32,16), // LAYER_BOMBER
    ENCODE_SIZE(32,16), // LAYER_LEVELBOSS
    ENCODE_SIZE(16,16), // LAYER_WARP
    ENCODE_SIZE(16,16), // LAYER_PLAYER
    ENCODE_SIZE(64,16), // LAYER_CLOUDS2
    ENCODE_SIZE(32,16), // LAYER_ASTROS2
    ENCODE_SIZE(16,8 ), // LAYER_SCORES
};

const int8_t spriteSizeByMisc[] = 
{
    //          W , H
    ENCODE_SIZE(64,16), // progress
    ENCODE_SIZE(8 ,8 ), // stage
    ENCODE_SIZE(64,16), // time
    ENCODE_SIZE(64,16), // pilot
    ENCODE_SIZE(64,8 ), // blank1
    ENCODE_SIZE(64,8 ), // blank2
};

const uint8_t spriteVRAMAddress_hi[] = {
    0x09, // LAYER_CLOUDS0
    0x09, // LAYER_ASTROS0
    0x09, // LAYER_CLOUDS1
    0x09, // LAYER_ASTROS1
    0x09, // LAYER_ENEMY_BULLETS
    0x09, // LAYER_ENEMY_SPACEBULLETS
    0x09, // LAYER_ENEMY_BOMBS
    0x09, // LAYER_ENEMY_ROCKETS
    0x09, // LAYER_ENEMY_BOOMERANG
    0x09, // LAYER_ENEMY
    0x09, // LAYER_PLAYER_BULLETS
    0x09, // LAYER_PARACHUTE
    0x09, // LAYER_BOMBER
    0x0a, // LAYER_LEVELBOSS
    0x0a, // LAYER_WARP
    0x0a, // LAYER_PLAYER
    0x0a, // LAYER_CLOUDS2
    0x0a, // LAYER_ASTROS2
    0x0a, // LAYER_SCORES
};

const uint8_t spriteVRAMAddress_lo[] = {
    0x60, // LAYER_CLOUDS0
    0x64, // LAYER_ASTROS0
    0x68, // LAYER_CLOUDS1
    0x70, // LAYER_ASTROS1
    0x74, // LAYER_ENEMY_BULLETS
    0x75, // LAYER_ENEMY_SPACEBULLETS
    0x7d, // LAYER_ENEMY_BOMBS
    0x7f, // LAYER_ENEMY_ROCKETS
    0xbf, // LAYER_ENEMY_BOOMERANG
    0xbf, // LAYER_ENEMY
    0xc9, // LAYER_PLAYER_BULLETS
    0xca, // LAYER_PARACHUTE
    0xda, // LAYER_BOMBER
    0x1a, // LAYER_LEVELBOSS
    0x1b, // LAYER_WARP
    0x2b, // LAYER_PLAYER
    0xab, // LAYER_CLOUDS2
    0xbb, // LAYER_ASTROS2
    0xc3, // LAYER_SCORES
};

// LAYER_LEVELBOSS
const uint8_t spriteVRAMBosses_hi[] = {
    0x0c, // l0boss
    0x0c, // l1boss
    0x0c, // l2boss
    0x0c, // l3boss
    0x0d, // l4boss
};

const uint8_t spriteVRAMBosses_lo[] = {
    0x1b, // l0boss
    0x5b, // l1boss
    0x9b, // l2boss
    0xdb, // l3boss
    0x1b, // l4boss
};

// LAYER_ENEMY
const uint8_t spriteVRAMEnemies_hi[] = {
    0x0b, // l0enemy
    0x0b, // l1enemy
    0x0b, // l2enemy
    0x0b, // l3enemy
    0x0c, // l4enemy
};

const uint8_t spriteVRAMEnemies_lo[] = {
    0x2f, // l0enemy
    0x6f, // l1enemy
    0xaf, // l2enemy
    0xd3, // l3enemy
    0x13, // l4enemy
};

const uint8_t spriteVRAMExplosions_hi[] = {
    0x0a, // expl16x16
    0x0a, // expl32x16
    0x0a, // expl_boom11x11
    0x0b, // expl_sblt13x13
    0x0b, // expl_wep16x16
};

const uint8_t spriteVRAMExplosions_lo[] = {
    0xcf, // expl16x16
    0xdf, // expl32x16
    0xff, // expl_boom11x11
    0x0f, // expl_sblt13x13
    0x1f, // expl_wep16x16
};

const uint8_t spriteVRAMMisc_hi[] = {
    0x09, // progress
    0x0a, // stage
    0x0d, // time
    0x0d, // pilot
    0x0d, // blank1
    0x0d, // blank2
};

const uint8_t spriteVRAMMisc_lo[] = {
    0xc7, // progress
    0x1a, // stage
    0x2b, // time
    0x3b, // pilot
    0x4b, // blank1
    0x53, // blank2
};

const int8_t stageBossAudio[5] = {
    AUDIO_BOSSL0,
    AUDIO_BOSSL1,
    AUDIO_BOSSL2,
    AUDIO_BOSSL3,
    AUDIO_BOSSL4
};

const uint8_t stageLabelColor[3] = {
    TP_COLOR_WHITE, TP_COLOR_BLUE, TP_COLOR_RED
};

const char** stageLabelText[5] = {
    &TEXT_PERIOD0_1910,
    &TEXT_PERIOD1_1940,
    &TEXT_PERIOD2_1970,
    &TEXT_PERIOD3_1982,
    &TEXT_PERIOD4_2001
};

/* This array nees some explanation:
   Position index
   Length (Start at position index and increment length times drawing a row of this sprite)
   frame from sprite sheet
   length again, but if -1 end this draw run
   You can reat this as something like:
   starting at position 5 (so 88), 3 sprites from frame 0 and yeild; then
   stating at 72, 5 sprites from frame 0; yield, etc.
*/
const int8_t timeWarpDrawScript[] = {
    11,6,22,-1,
    9,10,22,-1,
    7,14,22,-1,
    5,18,22,-1,
    3,22,22,-1,
    0,28,22,-1,
    0,28,22,9,10,23,-1,
    0,28,22,7,14,23,-1,
    0,28,22,5,18,23,9,10,24,-1,
    0,28,22,3,22,23,7,14,24,13,1,25,14,1,26,-1,
    0,28,22,3,22,23,7,14,24,13,1,25,14,1,26,-1,
    0,28,22,3,22,23,7,14,24,13,1,25,14,1,26,-1,
    0,28,22,3,22,23,7,14,24,13,1,25,14,1,26,-1,
    0,28,22,5,18,23,9,10,24,-1,
    0,28,22,7,14,23,-1,
    0,28,22,9,10,23,-1,
    0,28,22,-1,
    3,22,22,-1,
    5,18,22,-1,
    7,14,22,-1,
    9,10,22,-1,
    11,6,22,-1,
    -1,
};

//-----------------------------------------------------------------------------
// Audio data
// start bank, start offset, end bank, end offset, looping sample
AudioData audioData[NUM_AUDIO_SOURCES] = {
    {0x01,0x0000,0x01,0x153E,0}, // AUDIO_COINDROP
    {0x01,0x153F,0x0C,0x0926,0}, // AUDIO_GAME_START
    {0x0C,0x0927,0x17,0x0577,1}, // AUDIO_HIGHSCORE
    {0x17,0x0578,0x19,0x035C,0}, // AUDIO_NEXT_LEVEL
    {0x19,0x035D,0x19,0x0960,0}, // AUDIO_PLAYER_SHOOT
    {0x19,0x0961,0x19,0x17D9,1}, // AUDIO_ROCKET_FLY
    {0x19,0x17DA,0x1A,0x00BC,1}, // AUDIO_BOSSL0
    {0x1A,0x00BD,0x1A,0x195D,1}, // AUDIO_BOSSL1
    {0x1A,0x195E,0x1B,0x0101,1}, // AUDIO_BOSSL2
    {0x1B,0x0102,0x1B,0x0A3B,1}, // AUDIO_BOSSL3
    {0x1B,0x0A3C,0x1C,0x048C,0}, // AUDIO_WAPON_EXPLODE
    {0x1C,0x048D,0x1C,0x1C8E,0}, // AUDIO_ENEMY_EXPLODE
    {0x1C,0x1C8F,0x1D,0x05E8,0}, // AUDIO_ENEMY_SHOOT
    {0x1D,0x05E9,0x1E,0x024F,0}, // AUDIO_BOMB
    {0x1E,0x0250,0x1E,0x12A8,0}, // AUDIO_ROCKET_LAUNCH
    {0x1E,0x12A9,0x1F,0x14CB,0}, // AUDIO_PICKUP
    {0x1F,0x14CC,0x20,0x11FD,0}, // AUDIO_EXTRA_LIFE
    {0x20,0x11FE,0x21,0x024B,0}, // AUDIO_WAVE_START
    {0x21,0x024C,0x23,0x03D6,0}, // AUDIO_BIG_EXPLOSION
    {0x23,0x03D7,0x2B,0x0E1C,0}, // AUDIO_TIMEWARP
};

//-----------------------------------------------------------------------------
// Replay data
uint8_t demoAttractBuffer[DEMO_ATTRACT_LENGTH] = {
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
    0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x48,0x48,0x48,0x49,0x09,0x09,0x09,0x00,0x00,0x40,0x41,0x41,0x01,0x01,0x01,
    0x01,0x00,0x00,0x40,0x40,0x40,0x40,0x00,0x02,0x02,0x43,0x43,0x43,0x03,0x03,0x02,
    0x42,0x42,0x42,0x06,0x06,0x06,0x46,0x46,0x06,0x04,0x04,0x44,0x44,0x44,0x00,0x00,
    0x40,0x40,0x42,0x02,0x06,0x02,0x42,0x42,0x02,0x02,0x02,0x42,0x42,0x42,0x03,0x03,
    0x01,0x41,0x41,0x41,0x09,0x09,0x49,0x49,0x49,0x09,0x09,0x09,0x08,0x48,0x48,0x0C,
    0x0C,0x04,0x44,0x44,0x44,0x06,0x06,0x06,0x00,0x40,0x40,0x49,0x09,0x09,0x49,0x49,
    0x49,0x49,0x09,0x09,0x49,0x49,0x49,0x09,0x01,0x01,0x41,0x43,0x42,0x02,0x02,0x02,
    0x42,0x42,0x42,0x02,0x02,0x02,0x42,0x46,0x46,0x06,0x06,0x06,0x46,0x46,0x46,0x04,
    0x04,0x04,0x44,0x48,0x48,0x08,0x09,0x09,0x49,0x49,0x49,0x01,0x01,0x40,0x40,0x40,
    0x00,0x01,0x41,0x41,0x01,0x01,0x01,0x41,0x40,0x48,0x48,0x08,0x08,0x40,0x40,0x40,
    0x00,0x00,0x09,0x49,0x49,0x48,0x08,0x04,0x04,0x44,0x44,0x40,0x09,0x09,0x09,0x09,
    0x41,0x41,0x01,0x03,0x03,0x43,0x43,0x43,0x03,0x03,0x42,0x42,0x02,0x02,0x02,0x02,
    0x02,0x46,0x46,0x44,0x44,0x04,0x04,0x08,0x08,0x49,0x49,0x49,0x09,0x09,0x01,0x41,
    0x41,0x43,0x03,0x03,0x03,0x42,0x46,0x46,0x02,0x02,0x43,0x43,0x41,0x41,0x01,0x01,
    0x01,0x09,0x49,0x49,0x48,0x48,0x08,0x0C,0x04,0x44,0x44,0x46,0x06,0x06,0x06,0x46,
    0x42,0x42,0x02,0x03,0x03,0x43,0x43,0x43,0x03,0x03,0x01,0x41,0x41,0x03,0x02,0x02,
    0x42,0x46,0x46,0x06,0x04,0x04,0x09,0x49,0x49,0x49,0x49,0x09,0x09,0x09,0x09,0x08,
    0x04,0x04,0x44,0x44,0x44,0x44,0x04,0x04,0x40,0x49,0x49,0x09,0x09,0x09,0x09,0x40,
    0x46,0x06,0x06,0x06,0x46,0x46,0x46,0x04,0x04,0x44,0x44,0x44,0x04,0x00,0x00,0x40,
    0x40,0x00,0x00,0x00,0x40,0x40,0x00,0x00,0x00,0x42,0x42,0x02,0x02,0x02,0x40,0x40,
    0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x40,0x40,0x00,0x00,0x00,0x40,0x40,0x00,0x00,
    0x00,0x40,0x40,0x00,0x00,0x00,0x40,0x40,0x00,0x00,0x00,0x40,0x40,0x00,0x00,0x00,
    0x40,0x40,0x00,0x00,0x40,0x41,0x41,0x01,0x01,0x01,0x41,0x40,0x00,0x00,0x40,0x40,
    0x40,0x00,0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x00,0x42,0x42,0x42,0x02,0x02,0x00,
    0x00,0x40,0x41,0x49,0x49,0x09,0x09,0x09,0x01,0x41,0x41,0x01,0x01,0x01,0x49,0x49,
    0x49,0x49,0x09,0x09,0x49,0x48,0x48,0x08,0x08,0x00,0x40,0x41,0x41,0x01,0x01,0x01,
    0x41,0x41,0x41,0x01,0x01,0x01,0x41,0x41,0x41,0x09,0x09,0x08,0x48,0x48,0x48,0x48,
    0x08,0x0C,0x0C,0x44,0x44,0x44,0x44,0x06,0x06,0x06,0x46,0x46,0x46,0x06,0x04,0x04,
    0x04,0x44,0x4C,0x4C,0x0C,0x0C,0x0C,0x4C,0x4C,0x4C,0x0C,0x0C,0x0C,0x0C,0x4C,0x48,
    0x48,0x09,0x09,0x09,0x09,0x49,0x49,0x09,0x09,0x09,0x09,0x49,0x49,0x49,0x09,0x09,
    0x01,0x41,0x41,0x41,0x01,0x03,0x03,0x43,0x43,0x43,0x03,0x03,0x03,0x42,0x42,0x42,
    0x02,0x02,0x02,0x02,0x46,0x46,0x46,0x06,0x04,0x04,0x04,0x44,0x4C,0x4C,0x4C,0x0C,
    0x0C,0x4C,0x4C,0x48,0x08,0x08,0x48,0x48,0x4C,0x4C,0x0C,0x4C,0x4C,0x4C,0x4C,0x08,
    0x09,0x09,0x49,0x49,0x49,0x01,0x01,0x41,0x41,0x41,0x03,0x03,0x03,0x43,0x43,0x43,
    0x02,0x02,0x02,0x42,0x42,0x02,0x01,0x01,0x41,0x41,0x41,0x01,0x01,0x01,0x49,0x49,
    0x49,0x09,0x09,0x09,0x40,0x00,0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x41,0x41,0x40,
    0x00,0x00,0x40,0x40,0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x40,0x40,0x40,0x00,0x00,
    0x01,0x49,0x49,0x49,0x08,0x08,0x0C,0x4C,0x4C,0x4C,0x0C,0x0C,0x0C,0x48,0x40,0x40,
    0x00,0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x00,0x40,0x00,0x00,0x04,0x04,0x40,0x40,
    0x40,0x42,0x06,0x06,0x46,0x46,0x46,0x06,0x06,0x06,0x46,0x42,0x42,0x00,0x00,0x00,
    0x40,0x40,0x40,0x04,0x0C,0x0C,0x4C,0x4C,0x4C,0x0C,0x0C,0x0C,0x4C,0x48,0x08,0x08,
    0x08,0x48,0x4C,0x4C,0x04,0x04,0x44,0x44,0x04,0x04,0x04,0x44,0x44,0x04,0x04,0x00,
    0x00,0x40,0x49,0x09,0x09,0x09,0x49,0x49,0x49,0x09,0x09,0x09,0x49,0x49,0x09,0x09,
    0x49,0x49,0x41,0x41,0x01,0x01,0x03,0x02,0x42,0x42,0x42,0x03,0x03,0x01,0x41,0x41,
    0x41,0x01,0x03,0x43,0x41,0x41,0x41,0x01,0x01,0x41,0x49,0x49,0x49,0x09,0x09,0x09,
    0x48,0x48,0x48,0x0C,0x0C,0x0C,0x4C,0x48,0x08,0x08,0x00,0x04,0x44,0x44,0x44,0x44,
    0x44,0x46,0x46,0x06,0x06,0x02,0x42,0x42,0x42,0x02,0x02,0x02,0x02,0x42,0x42,0x43,
    0x41,0x01,0x01,0x01,0x40,0x40,0x44,0x04,0x04,0x06,0x46,0x44,0x44,0x04,0x04,0x04,
    0x44,0x44,0x4C,0x08,0x08,0x08,0x09,0x49,0x49,0x49,0x08,0x08,0x04,0x44,0x44,0x44,
    0x04,0x04,0x04,0x04,0x04,0x44,0x44,0x44,0x44,0x00,0x09,0x09,0x49,0x49,0x49,0x01,
    0x01,0x41,0x41,0x41,0x41,0x09,0x09,0x49,0x49,0x49,0x09,0x09,0x01,0x01,0x41,0x41,
    0x41,0x09,0x08,0x08,0x08,0x4C,0x4C,0x4C,0x44,0x04,0x04,0x04,0x44,0x44,0x44,0x04,
    0x04,0x04,0x44,0x40,0x40,0x09,0x09,0x09,0x49,0x49,0x09,0x01,0x00,0x40,0x40,0x40,
    0x00,0x00,0x01,0x41,0x41,0x41,0x01,0x01,0x01,0x01,0x41,0x41,0x41,0x01,0x01,0x03,
    0x42,0x42,0x42,0x06,0x06,0x06,0x06,0x06,0x46,0x46,0x46,0x02,0x02,0x00,0x02,0x42,
    0x42,0x42,0x06,0x06,0x02,0x42,0x42,0x42,0x02,0x02,0x02,0x42,0x42,0x46,0x06,0x06,
    0x06,0x46,0x46,0x46,0x06,0x00,0x00,0x41,0x41,0x41,0x01,0x01,0x01,0x41,0x41,0x41,
    0x01,0x01,0x01,0x41,0x41,0x01,0x01,0x01,0x40,0x40,0x40,0x00,0x00,0x41,0x41,0x41,
    0x01,0x01,0x01,0x43,0x42,0x02,0x02,0x02,0x43,0x41,0x41,0x01,0x01,0x01,0x41,0x41,
    0x41,0x01,0x01,0x03,0x42,0x42,0x42,0x02,0x02,0x03,0x43,0x41,0x01,0x01,0x01,0x01,
    0x43,0x02,0x02,0x01,0x41,0x42,0x42,0x02,0x02,0x42,0x42,0x42,0x02,0x02,0x06,0x46,
    0x46,0x46,0x06,0x04,0x04,0x04,0x48,0x48,0x49,0x09,0x09,0x09,0x09,0x09,0x49,0x49,
    0x49,0x09,0x09,0x09,0x41,0x41,0x41,0x01,0x01,0x00,0x40,0x40,0x40,0x00,0x00,0x08,
    0x49,0x49,0x09,0x08,0x08,0x00,0x40,0x40,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x40,
    0x40,0x00,0x00,0x00,0x00,0x40,0x41,0x41,0x01,0x01,0x01,0x01,0x41,0x41,0x43,0x03,
    0x03,0x03,0x43,0x43,0x43,0x01,0x01,0x01,0x01,0x43,0x43,0x42,0x42,0x02,0x01,0x41,
    0x41,0x41,0x03,0x02,0x02,0x42,0x42,0x46,0x06,0x06,0x06,0x06,0x42,0x42,0x42,0x42,
    0x02,0x02,0x06,0x46,0x46,0x46,0x06,0x06,0x02,0x02,0x42,0x42,0x42,0x02,0x06,0x06,
    0x06,0x46,0x46,0x46,0x46,0x06,0x06,0x06,0x46,0x46,0x46,0x44,0x04,0x04,0x04,0x44,
    0x4C,0x4C,0x4C,0x4C,0x0C,0x0C,0x0C,0x0C,0x4C,0x4C,0x4C,0x0C,0x0C,0x0C,0x0C,0x4C,
    0x4C,0x48,0x09,0x09,0x09,0x01,0x41,0x41,0x41,0x01,0x03,0x03,0x43,0x43,0x42,0x02,
    0x02,0x02,0x41,0x41,0x01,0x01,0x01,0x41,0x49,0x09,0x09,0x09,0x41,0x41,0x41,0x41,
    0x09,0x09,0x09,0x09,0x49,0x49,0x41,0x03,0x02,0x02,0x43,0x43,0x43,0x03,0x03,0x03,
    0x42,0x42,0x42,0x42,0x02,0x02,0x42,0x42,0x46,0x46,0x06,0x06,0x06,0x46,0x42,0x42,
    0x41,0x01,0x09,0x09,0x49,0x49,0x49,0x49,0x09,0x09,0x09,0x49,0x49,0x49,0x09,0x09,
    0x09,0x49,0x40,0x40,0x00,0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x00,0x40,0x40,0x00,
    0x00,0x40,0x40,0x00,0x00,0x40,0x40,0x40,0x00,0x00,0x40,0x40,0x40,0x40,0x00,0x09,
    0x09,0x49,0x49,0x09,0x09,0x08,0x40,0x40,0x40,0x00,0x00,0x40,0x48,0x48,0x08,0x08,
    0x08,0x48,0x48,0x48,0x48,0x00,0x00,0x00,0x40,0x40,0x40,0x0C,0x0C,0x0C,0x0C,0x4C,
    0x4C,0x40,0x00,0x00,0x40,0x48,0x49,0x09,0x09,0x09,0x08,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

//-----------------------------------------------------------------------------
void dataCleanup() {
}

//-----------------------------------------------------------------------------
int8_t dataInit() {
    uint8_t h, i;
    char fileName[18];


    // Load the sprites ($13000)
    cbm_k_setlfs(0, 8, 1);
    cbm_k_setnam("assets/tpspr.vrm");
    h = cbm_k_open();
    cbm_k_load(3, 0);
    cbm_k_close(h);

    // Load the font (from char 16 - $1F080)
    cbm_k_setlfs(0, 8, 1);
    cbm_k_setnam("assets/tpfont.vrm");
    h = cbm_k_open();
    cbm_k_load(3, 0);
    cbm_k_close(h);

    // Set up but don't show yet
    // Up to 6 extra lives ships
    for(i=0; i<NUM_UI_SPR_EXTRA_LIVES; i++) {
        drawSetOtherSprite(UI_SPR_EXTRA_LIVES+i, LAYER_PLAYER, (SCREENW-16)-i*16, 19*SROWH, FRAME_OFFSET(16,16)*PLAYER_FRAME_UP);
    }
    // 5 stage indicator sprites - this is actually not right since TP has a proper counting system that
    // I decided not to implement since I can't see almost anyone actually noticing
    for(i=0; i<NUM_UI_SPR_STAGE_INDEX; i++) {
        drawSetOtherSprite(UI_SPR_STAGE_INDEX+i, UI_LAYER_STAGE, (SCREENW-8)-i*8, 16*SROWH, 0);
    }
    // TIME and PILOT as 2 sprites
    drawSetOtherSprite(UI_SPR_LOGO  , UI_LAYER_TIME , (PLAYFIELDW/2)*SCOLW-64, 16, 0);
    drawSetOtherSprite(UI_SPR_LOGO+1, UI_LAYER_PILOT, (PLAYFIELDW/2)*SCOLW+8 , 16, 0);
    // The 2 progress bar blanks
    drawSetOtherSprite(UI_SPR_PROGRESS  , UI_LAYER_BLANK1, SCREENW-96, 24*SROWH, 0);
    drawSetOtherSprite(UI_SPR_PROGRESS+1, UI_LAYER_BLANK2, SCREENW-32, 24*SROWH, 0);
    // Always Show the progress sprites
    drawShowSprite(UI_SPR_PROGRESS  , 0b00001100);
    drawShowSprite(UI_SPR_PROGRESS+1, 0b00001100);

    // Only because the audio loading takes so long
    drawShowSprite(UI_SPR_LOGO, 0b00000100);
    drawShowSprite(UI_SPR_LOGO+1, 0b00000100);

    VERA.audio.rate = 0;
    // Load the sounds
    for(i = 0; i < audioData[NUM_AUDIO_SOURCES-1].end_bank; i++) {
        printXY(0, 11, 6, 0, i & 15, "LOADING");
        sprintf(fileName, "assets/bank%03d.au", i);
        cbm_k_setlfs(0, 8, 1);
        cbm_k_setnam(fileName);
        h = cbm_k_open();
        RAM_RAM_BANK = i;
        cbm_k_load(0, 0);
        RAM_RAM_BANK = 0;
        cbm_k_close(h);
    }

    demoAttractLength = sizeof(demoAttractBuffer);
    return 1;
}
